{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}
<form method="post" class="form-container" id="editUserForm">
    {% csrf_token %}
    {% crispy form %}
    <button type="submit" class="btn btn-primary">Guardar cambios</button>
</form>

<script>
    document.getElementById('editUserForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const userId = "{{ empleado.id_user.id }}";
        fetch(`/users/edit/${userId}/`, {
            method: 'POST',
            body: new FormData(this),
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Usuario actualizado exitosamente');
                location.reload();
            } else {
                alert('Error al actualizar usuario');
            }
        });
    });
</script>
{% endblock %}